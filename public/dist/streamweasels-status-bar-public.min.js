(()=>{"use strict";function t(t,e,a){const s=parseInt(t.dataset.barLoading??"0");if(t.dataset.barLoading=(s-1).toString(),"live"!==t.dataset.liveStatus&&(t.dataset.liveStatus=e.liveStatus??"offline"),"live"===e.liveStatus){var r=t.querySelector(".cp-sw-status-bar__viewers--line-2").textContent??"0",i=parseInt(r),n=parseInt(e.viewers??"0");t.classList.add("l-stream-online","l-stream-online--"+a),t.querySelector(".cp-sw-status-bar__indicator").classList.add("cp-sw-status-bar__indicator--online"),t.querySelector(`.l-${a}-cta`).dataset.status="live",t.querySelector(`.l-${a}-cta`).dataset.viewers=e.viewers??"",n>i&&(t.querySelector(".cp-sw-status-bar__game--line-2").textContent=e.game??"",t.querySelector(".cp-sw-status-bar__viewers--line-2").textContent=e.viewers??"")}else t.querySelector(`.l-${a}-cta`).dataset.status="offline"}async function e(e,a,s,r,i){const n=i.dataset.siteUrl??"";if(e){const a=await async function(t,e,a){let s={liveStatus:"offline",game:"N/A",viewers:"0"};try{const r=await fetch(e+`/?rest_route=/swsb/v1/fetch-streams/&user_login=${t}`,{headers:{"X-WP-Nonce":a}});if(!r.ok)throw new Error(`Failed to fetch stream data: HTTP status ${r.status}`);const i=await r.json();return i.data&&"live"===i.data[0]?.type&&(s={liveStatus:i.data[0].type,game:i.data[0].game_name,viewers:i.data[0].viewer_count}),{streamData:s}}catch(t){return console.error("Error fetching stream data:",t),{streamData:s}}}(e,n,r);t(i,a.streamData,"twitch")}if(a){const e=await async function(t,e){let a={liveStatus:"offline",game:"N/A",viewers:"0"};try{const s=await fetch(`https://kick.com/api/v1/channels/${t}`,{headers:{"X-WP-Nonce":e}});if(!s.ok)throw new Error(`Failed to fetch stream data: HTTP status ${s.status}`);const r=await s.json();return r&&r.livestream&&(a={liveStatus:r.livestream.is_live?"live":"offline",game:r.livestream.categories[0].category.name,viewers:r.livestream.viewer_count}),{streamData:a}}catch(t){return console.error("Error fetching stream data:",t),{streamData:a}}}(a,r);t(i,e.streamData,"kick")}if(s){const e=await async function(t,e,a){let s={liveStatus:"offline",game:"N/A",viewers:"0"};try{const r=await fetch(e+`/?rest_route=/swsb/v1/fetch-youtube/&user_login=${t}`,{headers:{"X-WP-Nonce":a}});if(!r.ok)throw new Error(`Failed to fetch stream data: HTTP status ${r.status}`);const i=await r.json();if(i.items&&"live"===i.items[0]?.snippet?.liveBroadcastContent){const t=await async function(t,e,a){try{const s=await fetch(e+`/?rest_route=/swsb/v1/fetch-youtube-viewers/&id=${t}`,{headers:{"X-WP-Nonce":a}});if(!s.ok)throw new Error(`Failed to fetch extra data: HTTP status ${s.status}`);const r=await s.json();if(r.items&&r.items[0]?.snippet?.categoryId){const t=await async function(t,e,a){try{const s=await fetch(e+`/?rest_route=/swsb/v1/fetch-youtube-category/&id=${t}`,{headers:{"X-WP-Nonce":a}});if(!s.ok)throw new Error(`Failed to fetch extra data: HTTP status ${s.status}`);const r=await s.json();if(r&&r.items[0]?.snippet?.title)return r.items[0]?.snippet?.title;throw new Error("Failed to fetch extra data: Invalid data format")}catch(t){throw new Error(`Failed to fetch extra data: ${t.message}`)}}(r.items[0]?.snippet?.categoryId,e,a);return{game:t,viewers:r.items[0]?.liveStreamingDetails?.concurrentViewers}}throw new Error("Failed to fetch extra data: Invalid data format")}catch(t){throw new Error(`Failed to fetch extra data: ${t.message}`)}}(i.items[0]?.id?.videoId,e,a);s={liveStatus:i.items[0]?.snippet?.liveBroadcastContent,game:t.game,viewers:t.viewers}}return{streamData:s}}catch(t){return console.error("Error fetching stream data:",t),{streamData:s}}}(s,n,r);t(i,e.streamData,"youtube")}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".cp-sw-status-bar").forEach((t=>{!function(t){const a={uuid:t.dataset.uuid||"",twitchUsername:t.dataset.twitchUsername,kickUsername:t.dataset.kickUsername,youtubeUsername:t.dataset.youtubeUsername,nonce:t.dataset.nonce||""};e(a.twitchUsername,a.kickUsername,a.youtubeUsername,a.nonce,t)}(t)}))}))})();